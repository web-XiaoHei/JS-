# 响应式原理

# 1.什么是响应式？

# 2.响应式函数的封装

```js
const reactiveFns = [];
watchFn(fn);
```

# 3.Depend 类的封装

```js
class Depend {
  constructor() {
    this.reactiveFns = [];
  }
  addDepend(reactiveFn) {
    this.reactiveFns.push(reactiveFn);
  }
  notify() {
    this.reactiveFns.forEach((fn) => {
      fn();
    });
  }
}
```

# 4.监听对象的变化

```js
 new Proxy(,set:depend.notify())
```

# 5.依赖收集的数据解构

对于每个 target 对象创建一个 Map 对象将属性和依赖函数进行关联
创建 WeakMap 保存 target 对象以及 target 对象对应的 Map 对象作为一个缓存区
WeakMap.get(target 对象)获取存储的 target 对象对应的 Map 进行遍历

# 6.正确的收集依赖

- Proxy 的 get 方法中收集对应的函数
- 全局 activeReactiveFn 变量
- 在 get 中找到 depend 对象，addDepend(全局 activeReactiveFn 变量)

# 7.对 Depend 进行优化

- addDepend 函数转换成 depend 函数
- 直接获取到的自由变量
- 将之前保存的数组变声 Set，避免重复

# 8.对对象的响应式操作

- 封装 reactive 函数
- new Proxy():vue3
- Object.defineProperty():vue2
